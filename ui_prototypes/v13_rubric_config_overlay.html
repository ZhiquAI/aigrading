<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rubric Config Overlay (V13)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            overflow: hidden;
        }

        ::-webkit-scrollbar {
            width: 4px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 2px;
        }

        /* Drawer Transitions */
        .drawer-overlay {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .drawer-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .drawer-content {
            transform: translateY(100%);
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .drawer-overlay.active .drawer-content {
            transform: translateY(0);
        }

        /* Smooth inputs */
        .input-ghost {
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .input-ghost:hover {
            background: #f8fafc;
        }

        .input-ghost:focus {
            background: white;
            border-color: #e2e8f0;
            outline: none;
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.1);
        }

        /* Magic Zone Animation */
        .magic-zone {
            background: linear-gradient(135deg, #eef2ff 0%, #f5f3ff 100%);
            border: 2px dashed #c7d2fe;
            transition: all 0.3s;
        }

        .magic-zone:hover {
            border-color: #6366f1;
            transform: scale(1.01);
        }

        .magic-zone.dragging {
            border-color: #6366f1;
            background: #e0e7ff;
        }

        /* Score Badge */
        .score-input {
            text-align: center;
            font-weight: bold;
            color: #4338ca;
            background: #e0e7ff;
            border: none;
            border-radius: 4px;
            width: 32px;
            padding: 2px 0;
            font-size: 11px;
        }

        .score-input:focus {
            outline: 2px solid #6366f1;
            background: white;
        }
    </style>
</head>

<body class="text-slate-800 h-screen w-screen relative bg-slate-100 flex items-center justify-center">

    <!-- BACKGROUND (Simulated V12 Main Page) -->
    <div class="w-full h-full max-w-[480px] bg-white relative flex flex-col shadow-2xl overflow-hidden">
        <!-- V12 Header -->
        <header
            class="bg-white/80 backdrop-blur-md border-b border-slate-200 px-4 py-3 flex items-center justify-between shrink-0 h-14">
            <h1 class="font-bold text-slate-800 text-lg tracking-tight">智能阅卷</h1>
            <div class="flex items-center gap-2">
                <button class="p-2 hover:bg-slate-50 rounded-full text-slate-400"><i data-lucide="settings-2"
                        class="w-5 h-5"></i></button>
            </div>
        </header>

        <!-- V12 Content (Idle State with Config Trigger) -->
        <main class="flex-1 flex flex-col items-center justify-center p-6 bg-slate-50/50">
            <div class="relative w-32 h-32 flex items-center justify-center mb-6 opacity-50 grayscale transition-all duration-500"
                id="main-orb">
                <div class="absolute inset-0 border border-slate-200 rounded-full"></div>
                <div class="w-20 h-20 bg-slate-300 rounded-full flex items-center justify-center text-white">
                    <i data-lucide="scan-line" class="w-8 h-8"></i>
                </div>
            </div>

            <div class="text-center space-y-4">
                <div>
                    <h2 class="text-lg font-bold text-slate-400">尚未配置评分细则</h2>
                    <p class="text-xs text-slate-400 mt-1">请先完成配置以启用 AI 阅卷</p>
                </div>

                <!-- TRIGGER BUTTON -->
                <button onclick="toggleDrawer(true)"
                    class="px-6 py-2.5 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-bold rounded-xl shadow-lg shadow-indigo-200 transition-all flex items-center gap-2 animate-pulse">
                    <i data-lucide="settings-2" class="w-4 h-4"></i>
                    配置评分细则
                </button>
            </div>
        </main>

        <!-- V12 Bottom Nav (Simulated) -->
        <nav class="h-16 border-t border-slate-100 bg-white flex items-center justify-around text-slate-300">
            <div class="flex flex-col items-center gap-1 w-14"><i data-lucide="check-circle-2" class="w-5 h-5"></i>
            </div>
            <div class="flex flex-col items-center gap-1 w-14"><i data-lucide="history" class="w-5 h-5"></i></div>
            <div class="flex flex-col items-center gap-1 w-14"><i data-lucide="pie-chart" class="w-5 h-5"></i></div>
        </nav>
    </div>

    <!-- ============================================== -->
    <!-- RUBRIC CONFIG OVERLAY (Bottom Sheet / Drawer) -->
    <!-- ============================================== -->
    <div id="rubric-drawer"
        class="drawer-overlay absolute inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex flex-col justify-end">

        <!-- Drawer Panel -->
        <div
            class="drawer-content bg-white w-full max-w-[480px] mx-auto h-[85vh] rounded-t-[24px] shadow-2xl flex flex-col overflow-hidden relative">

            <!-- Handle -->
            <div class="w-full flex justify-center pt-3 pb-1 shrink-0 cursor-pointer" onclick="toggleDrawer(false)">
                <div class="w-12 h-1.5 bg-slate-200 rounded-full"></div>
            </div>

            <!-- Header -->
            <header class="px-5 py-3 border-b border-slate-100 flex items-center justify-between shrink-0">
                <div>
                    <h2 class="text-base font-bold text-slate-800">评分细则配置</h2>
                    <p class="text-[10px] text-slate-400 flex items-center gap-1">
                        适用于
                        <span class="bg-indigo-50 text-indigo-600 px-1.5 py-0.5 rounded font-bold">18-2</span>
                        <span class="bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded font-medium">6分</span>
                    </p>
                </div>
                <button onclick="toggleDrawer(false)"
                    class="p-2 bg-slate-50 hover:bg-slate-100 rounded-full text-slate-500 font-medium text-xs transition-colors">
                    完成
                </button>
            </header>

            <!-- Scrollable Content -->
            <div class="flex-1 overflow-y-auto p-4 pb-24 space-y-6">

                <!-- 1. Question Context (Thumbnail) -->
                <section>
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-[11px] font-bold text-slate-400 uppercase tracking-wider">当前试题</span>
                        <button class="text-[11px] text-indigo-600 font-medium hover:underline">重新截取</button>
                    </div>
                    <div class="flex gap-3 bg-slate-50 p-2 rounded-xl border border-slate-100">
                        <div
                            class="w-20 h-20 bg-white rounded-lg border border-slate-200 overflow-hidden flex items-center justify-center shrink-0">
                            <!-- Placeholder image -->
                            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' fill='%23f1f5f9'/%3E%3Ctext x='50' y='50' font-family='sans-serif' font-size='12' text-anchor='middle' fill='%2394a3b8'%3EOCR Preview%3C/text%3E%3C/svg%3E"
                                class="w-full h-full object-cover opacity-80" alt="题干截图">
                        </div>
                        <div class="flex-1 py-1 pr-1 min-w-0">
                            <h3 class="text-xs font-bold text-slate-700 truncate mb-1">简述工业革命对社会结构的影响...</h3>
                            <p class="text-[10px] text-slate-400 line-clamp-2 leading-tight">
                                关键词提取: 资产阶级, 无产阶级, 城市化, 贫富差距, 生产关系...
                            </p>
                        </div>
                    </div>
                </section>

                <!-- 2. AI Magic Zone -->
                <section>
                    <div class="magic-zone rounded-xl p-4 text-center cursor-pointer group relative overflow-hidden"
                        onclick="simulateAIGen()">
                        <!-- Shine effect -->
                        <div
                            class="absolute inset-0 bg-gradient-to-r from-transparent via-white/40 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-1000">
                        </div>

                        <div
                            class="w-10 h-10 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mx-auto mb-2 group-hover:scale-110 transition-transform">
                            <i data-lucide="sparkles" class="w-5 h-5"></i>
                        </div>
                        <h3 class="text-xs font-bold text-indigo-900">AI 智能生成细则</h3>
                        <p class="text-[10px] text-indigo-600/70 mt-1">上传标准答案图片，自动提取得分点</p>
                    </div>
                </section>

                <!-- 3. Rubric List -->
                <section class="space-y-3">
                    <div class="flex items-center justify-between">
                        <span class="text-[11px] font-bold text-slate-400 uppercase tracking-wider">评分要点 (3)</span>
                        <div class="flex items-center gap-1.5 px-2 py-1 bg-slate-50 rounded-lg border border-slate-100">
                            <span class="text-[10px] text-slate-500">严格模式</span>
                            <div class="relative w-6 h-3.5 bg-slate-200 rounded-full cursor-pointer transition-colors"
                                onclick="this.classList.toggle('bg-indigo-500')">
                                <div
                                    class="absolute left-0.5 top-0.5 w-2.5 h-2.5 bg-white rounded-full shadow-sm transition-transform">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Items Container -->
                    <div class="space-y-2" id="rubric-list">

                        <!-- Rubric Item 1 -->
                        <div
                            class="group relative bg-white border border-slate-200 rounded-xl p-3 shadow-sm hover:border-indigo-400 transition-all">
                            <div class="flex justify-between items-start mb-2 gap-2">
                                <input type="text" value="经济结构变化"
                                    class="input-ghost flex-1 text-xs font-bold text-slate-700 bg-transparent rounded px-1 -ml-1">
                                <input type="text" value="2.0" class="score-input shrink-0">
                            </div>
                            <div class="relative">
                                <textarea rows="2"
                                    class="input-ghost w-full text-[11px] text-slate-500 bg-transparent rounded p-1 -ml-1 resize-none leading-relaxed">从手工工场向机器大工业过渡；工厂制度的确立。</textarea>
                            </div>
                            <!-- Delete Action (Hover) -->
                            <button
                                class="absolute -right-2 -top-2 bg-red-50 text-red-500 rounded-full p-1 opacity-0 group-hover:opacity-100 shadow-sm border border-red-100 hover:scale-110 transition-all transform scale-50 group-hover:scale-100">
                                <i data-lucide="x" class="w-3 h-3"></i>
                            </button>
                        </div>

                        <!-- Rubric Item 2 -->
                        <div
                            class="group relative bg-white border border-slate-200 rounded-xl p-3 shadow-sm hover:border-indigo-400 transition-all">
                            <div class="flex justify-between items-start mb-2 gap-2">
                                <input type="text" value="阶级关系变化"
                                    class="input-ghost flex-1 text-xs font-bold text-slate-700 bg-transparent rounded px-1 -ml-1">
                                <input type="text" value="2.0" class="score-input shrink-0">
                            </div>
                            <div class="relative">
                                <textarea rows="2"
                                    class="input-ghost w-full text-[11px] text-slate-500 bg-transparent rounded p-1 -ml-1 resize-none leading-relaxed">社会日益分裂为两大对立阶级：工业资产阶级和无产阶级。</textarea>
                            </div>
                            <button
                                class="absolute -right-2 -top-2 bg-red-50 text-red-500 rounded-full p-1 opacity-0 group-hover:opacity-100 shadow-sm border border-red-100 hover:scale-110 transition-all transform scale-50 group-hover:scale-100">
                                <i data-lucide="x" class="w-3 h-3"></i>
                            </button>
                        </div>

                        <!-- Rubric Item 3 -->
                        <div
                            class="group relative bg-white border border-slate-200 rounded-xl p-3 shadow-sm hover:border-indigo-400 transition-all">
                            <div class="flex justify-between items-start mb-2 gap-2">
                                <input type="text" value="城市化进程"
                                    class="input-ghost flex-1 text-xs font-bold text-slate-700 bg-transparent rounded px-1 -ml-1">
                                <input type="text" value="2.0" class="score-input shrink-0">
                            </div>
                            <div class="relative">
                                <textarea rows="2"
                                    class="input-ghost w-full text-[11px] text-slate-500 bg-transparent rounded p-1 -ml-1 resize-none leading-relaxed">人口向城市集中，城市规模扩大，现代城市兴起。</textarea>
                            </div>
                            <button
                                class="absolute -right-2 -top-2 bg-red-50 text-red-500 rounded-full p-1 opacity-0 group-hover:opacity-100 shadow-sm border border-red-100 hover:scale-110 transition-all transform scale-50 group-hover:scale-100">
                                <i data-lucide="x" class="w-3 h-3"></i>
                            </button>
                        </div>
                    </div>
                </section>

                <div class="h-8"></div> <!-- Spacer -->
            </div>

            <!-- Floating Action Button (Add) -->
            <div class="absolute bottom-6 right-6">
                <button onclick="addRubricItem()"
                    class="w-12 h-12 bg-indigo-600 hover:bg-indigo-700 text-white rounded-full shadow-lg shadow-indigo-500/40 flex items-center justify-center transition-transform active:scale-95 group">
                    <i data-lucide="plus" class="w-6 h-6 group-hover:rotate-90 transition-transform"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Generating Overlay (Hidden) -->
    <div id="gen-overlay" class="absolute inset-0 bg-white z-[60] flex flex-col items-center justify-center hidden">
        <div class="w-16 h-16 rounded-full bg-indigo-50 flex items-center justify-center mb-4 relative">
            <div class="absolute inset-0 border-4 border-indigo-100 rounded-full"></div>
            <div class="absolute inset-0 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin">
            </div>
            <i data-lucide="sparkles" class="w-6 h-6 text-indigo-500"></i>
        </div>
        <h3 class="text-sm font-bold text-slate-800 animate-pulse">正在解析标准答案...</h3>
        <p class="text-xs text-slate-400 mt-2">已识别 3 个得分点</p>
    </div>

    <script>
        lucide.createIcons();

        function toggleDrawer(show) {
            const drawer = document.getElementById('rubric-drawer');
            if (show) {
                drawer.classList.add('active');
            } else {
                drawer.classList.remove('active');
            }
        }

        function addRubricItem() {
            const list = document.getElementById('rubric-list');
            const newItem = document.createElement('div');
            newItem.className = 'group relative bg-white border border-slate-200 rounded-xl p-3 shadow-sm hover:border-indigo-400 transition-all animate-[fadeIn_0.3s_ease]';
            newItem.innerHTML = `
                <div class="flex justify-between items-start mb-2 gap-2">
                    <input type="text" placeholder="输入得分点标题" class="input-ghost flex-1 text-xs font-bold text-slate-700 bg-transparent rounded px-1 -ml-1 focus:bg-white">
                    <input type="text" value="1.0" class="score-input shrink-0">
                </div>
                <div class="relative">
                    <textarea rows="2" placeholder="输入详细描述或关键词" class="input-ghost w-full text-[11px] text-slate-500 bg-transparent rounded p-1 -ml-1 resize-none leading-relaxed focus:bg-white"></textarea>
                </div>
                <button onclick="this.parentElement.remove()" class="absolute -right-2 -top-2 bg-red-50 text-red-500 rounded-full p-1 opacity-0 group-hover:opacity-100 shadow-sm border border-red-100 hover:scale-110 transition-all transform scale-50 group-hover:scale-100">
                    <i data-lucide="x" class="w-3 h-3"></i>
                </button>
            `;
            list.appendChild(newItem);
            lucide.createIcons();

            // Auto focus
            newItem.querySelector('input').focus();
        }

        function simulateAIGen() {
            const overlay = document.getElementById('gen-overlay');
            overlay.classList.remove('hidden');

            setTimeout(() => {
                overlay.classList.add('hidden');
                addRubricItem();
                addRubricItem();
                // Show visuals
                const inputs = document.querySelectorAll('#rubric-list input[type="text"]');
                inputs[inputs.length - 2].value = "新生成的得分点 A";
                inputs[inputs.length - 1].value = "新生成的得分点 B";
            }, 1500);
        }
    </script>
</body>

</html>