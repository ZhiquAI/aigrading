# **多学科多题型评分细则管理与架构方案**

面对“多学科 x 多题型”的复杂性，不能为每种题型单独开发一套管理系统。我们需要一个 **“统一外壳，多态内核”** 的管理架构。

## **1\. 核心理念：多态架构 (Polymorphic Architecture)**

所有的评分细则，无论多么复杂，都应遵循统一的 **“元数据 \+ 策略配置”** 结构。

### **1.1 统一数据模型 (The Unified JSON Schema)**

不要把规则写死在字段里，而是把规则封装在 content 字段中。

{  
  "id": "rule\_001",  
  "title": "九年级历史材料分析通用模版",  
  "is\_template": true,  // 关键：是通用模版还是某道题的专用规则  
    
  // 1\. 统一元数据 (用于筛选和管理)  
  "metadata": {  
    "subject": "history",  
    "grade\_level": "grade\_9",  
    "question\_type": "material\_analysis",  
    "tags": \["期末考", "难点"\]  
  },

  // 2\. 多态策略配置 (内核)  
  // 这里的内容根据 strategy\_type 动态变化  
  "strategy\_type": "keyword\_hit", // 或者是 "step\_check", "rubric\_matrix"  
  "content": {  
    // 这里的结构对于“历史题”是关键词列表  
    // 对于“数学题”则是步骤列表  
    // 对于“作文”则是维度量表  
    "points": \[...\],   
    "constraints": \[...\]   
  }  
}

## **2\. 只有三种“评分策略” (The 3 Core Strategies)**

尽管学科不同，但评分逻辑本质上只有三类。管理好这三类，就管理好了所有学科。

| 策略类型 | 适用场景 | 数据结构特征 | UI 表现 |
| :---- | :---- | :---- | :---- |
| **A. 采点累加型 (Point Accumulation)** | 历史/政治(简答)、生物(填空) | list\<keyword\> (包含关键词即得分) | 列表 \+ 关键词标签 |
| **B. 逻辑步骤型 (Sequential Logic)** | 数学/物理(大题)、化学(推断) | list\<step\> (步骤1 \-\> 步骤2 \-\> 结果) | 有序步骤条 (Step Bar) |
| **C. 维度量表型 (Rubric Matrix)** | 语文/英语(作文)、艺术 | matrix\<dimension, level\> (内容/结构/文采) | 二维表格 (Table) |

**管理策略：** 在 UI 上，用户选择“学科”后，系统自动推荐对应的默认“策略类型”，但允许切换。

## **3\. Chrome Side Panel 管理界面设计**

在侧边栏有限的空间内，如何管理成百上千的规则？

### **3.1 界面层级设计**

引入 **“规则库 (Library)”** 视图，作为编辑器的上一级入口。

\[ 视图 1: 规则库首页 (Library) \]  
\+----------------------------------+  
| 🔍 搜索规则 (如 "勾股定理")        |  
\+----------------------------------+  
| \[我的模版\]   \[系统预设\]   \[最近\]   |  
\+----------------------------------+  
| 筛选: \[ 📐 数学 v \]  \[ 📝 大题 v \] |  
\+----------------------------------+  
|                                  |  
|  \[ 📂 2024期末考试专用规则组 \]     |  
|                                  |  
|  \[ 📄 几何证明题通用模版 \]         |  
|     Tag: 数学 / 8年级             |  
|     Type: 逻辑步骤型              |  
|                                  |  
|  \[ 📄 英语作文-议论文 \]            |  
|     Tag: 英语 / 9年级             |  
|     Type: 维度量表型              |  
|                                  |  
\+----------------------------------+  
|  \[ \+ 新建规则 \]  \[ 导入 \]         |  
\+----------------------------------+  
       | 点击某条规则  
       v  
\[ 视图 2: 规则实例化 (The Editor) \]  
(即之前设计的“卡片流”编辑界面)

### **3.2 关键管理功能**

1. **模版化 (Templating):**  
   * **痛点:** 每次都要重新设置“错别字扣0.5分”、“字数少于100扣2分”太麻烦。  
   * **解决:** 允许将一组通用的“扣分项”保存为 Global Constraints Template。在新建规则时，一键“引用”通用扣分模版。  
2. **继承与派生 (Inheritance):**  
   * 用户可以基于“英语作文通用模版”，修改其中的一项，然后保存为“2023期中考英语作文规则”。  
   * UI 操作：打开模版 \-\> 修改 \-\> 点击“另存为”。  
3. **学科自适应 UI (Adaptive UI):**  
   * 当 metadata.subject \= **"数学"** 时，Side Panel 编辑器自动隐藏“关键词模糊匹配”选项，强调“步骤顺序”。  
   * 当 metadata.subject \= **"语文"** 时，Side Panel 编辑器自动切换为“表格模式”供打分量表使用。

## **4\. AI 智能推荐管理**

利用 AI 解决“找不到规则”的问题。

* **场景:** 老师上传了一张“二元一次方程组”的图片。  
* **AI 动作:**  
  1. 识别题目内容。  
  2. 识别学科为“数学”。  
  3. **自动检索规则库:** "检测到这是数学计算题，推荐使用 \[数学-计算步骤模版\] 或 \[初二代数通用规则\]。"  
  4. **UI 反馈:** 在侧边栏顶部弹出一个 Toast: *"已为您匹配到 3 个相关评分模版，点击应用"*。

## **5\. 总结**

管理多学科规则的秘诀在于 **分类治理**：

1. **数据层:** 用一个统一的 JSON 结构兼容不同策略。  
2. **交互层:** 用 **"规则库 \-\> 模版 \-\> 实例"** 的三层级关系来组织。  
3. **智能层:** 让 AI 根据题目自动去库里捞规则，而不是让老师自己去翻。  

---

## **6\. v3 Schema 对照与模板库落地（2026-02-06）**

### **6.1 统一数据结构**

```json
{
  "version": "3.0",
  "metadata": {
    "questionId": "12",
    "title": "影响分析",
    "subject": "历史",
    "grade": "九年级",
    "questionType": "材料题",
    "examName": "期末考试"
  },
  "strategyType": "point_accumulation | sequential_logic | rubric_matrix",
  "content": {
    "scoringStrategy": { "type": "weighted | pick_n | all" },
    "points | steps | dimensions": [],
    "totalScore": 10
  },
  "constraints": [
    { "id": "c1", "type": "逻辑验证", "description": "若出现瓦特必须包含蒸汽机" }
  ]
}
```

### **6.2 模板库三层级**
- **系统模板**：全局共享、只读。
- **用户模板**：基于激活码/设备隔离。
- **实例细则**：具体题目配置，读取即迁移为 v3。

### **6.3 策略与 UI 对应**
- **point_accumulation** → 得分点卡片流
- **sequential_logic** → 步骤逻辑编辑器
- **rubric_matrix** → 维度矩阵编辑器
