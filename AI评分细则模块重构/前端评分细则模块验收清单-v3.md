# 前端评分细则模块验收清单（v3）

## 1. 验收目标
- 验证评分细则前端是否完成从 v2 到 v3 的主链路重构。
- 验证模板库、推荐、三策略编辑器、低置信度暂停等关键能力是否可用。
- 验证构建可通过且无阻断性回归。

## 2. 前置条件
- 后端可访问，且模板相关接口已可用：
  - `GET /api/rubric/templates`
  - `POST /api/rubric/templates`
  - `DELETE /api/rubric/templates`
  - `POST /api/ai/rubric/recommend`
- 后端数据库已完成迁移和模板种子（如需系统模板）。
- 前端本地可运行并能访问后端 `VITE_API_BASE_URL`。

## 3. 自动化检查（必过）
- [ ] 前端构建通过：`cd aigradingfrontend && npm run build`
- [ ] v3 类型与转换存在：
  - `aigradingfrontend/types/rubric-v3.ts`
  - `aigradingfrontend/utils/rubric-convert.ts`
- [ ] 三策略编辑器存在：
  - `aigradingfrontend/src/components/v2/views/rubric-editors/PointAccumulationEditor.tsx`
  - `aigradingfrontend/src/components/v2/views/rubric-editors/SequentialLogicEditor.tsx`
  - `aigradingfrontend/src/components/v2/views/rubric-editors/RubricMatrixEditor.tsx`
- [ ] 模板服务存在：`aigradingfrontend/services/rubric-templates.ts`

## 4. 功能验收场景（手工打勾）

### S01 v2 兼容迁移
- [ ] 导入一份 v2 rubric（`answerPoints/points` 结构）。
- [ ] 打开编辑弹窗后正常显示。
- [ ] 保存后本地数据以 v3 结构持久化（`version: "3.0"` + `metadata/strategyType/content`）。

### S02 三策略编辑器
- [ ] 切换到 `得分点累加`，可新增/删除得分点并保存。
- [ ] 切换到 `步骤逻辑`，可配置步骤并设置“严格顺序”。
- [ ] 切换到 `维度矩阵`，可配置维度、等级、分值并保存。

### S03 模板保存与模板库
- [ ] 在编辑弹窗点击“另存为模板”成功。
- [ ] 规则库可切到“模板库”视图。
- [ ] “我的模板/系统模板/最近使用”可切换并加载数据。

### S04 推荐模板
- [ ] 在编辑弹窗点击“获取推荐”可返回推荐列表。
- [ ] 点击“应用”后，表单被推荐模板内容覆盖。

### S05 模板应用链路
- [ ] 在模板库中点击“使用模板”，可进入编辑并正确带入结构。
- [ ] 用户模板可删除，系统模板不可误删（无删除入口或受限）。

### S06 自动阅卷低置信度暂停
- [ ] 评分结果含 `needsReview=true` 或 `confidence < 阈值` 时，自动模式被暂停。
- [ ] 页面出现人工复核提示，且不会自动提交下一份。

### S07 正常自动流程
- [ ] 非低置信度时，自动模式可进入倒计时并提交。
- [ ] 评分结果写入历史，分数与 breakdown 显示正确。

### S08 回归项
- [ ] 旧入口“创建评分细则”可正常打开。
- [ ] 评分细则列表检索/分组/导出不崩溃。
- [ ] Side Panel 页面加载无白屏。

## 5. 阻断缺陷定义
- P0：无法创建/保存评分细则；自动阅卷完全不可用；页面白屏。
- P1：模板库或推荐核心链路不可用；低置信度暂停失效。
- P2：局部交互异常（样式错位、次级按钮问题）但可绕过。

## 6. 出口标准
- 自动化检查全部通过。
- S01-S08 全部打勾。
- 无 P0/P1 缺陷；P2 有明确修复计划和版本承诺。

## 7. 执行方式
- 推荐使用脚本：`bash scripts/check-frontend-rubric-v3.sh`
- 脚本会生成报告到 `AI评分细则模块重构/` 目录。
