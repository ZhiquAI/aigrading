# å¼€å‘è®°å½• - 2026-01-14 ~ 2026-01-15

## ğŸ“‹ æœ¬æ¬¡ä¼šè¯å®Œæˆçš„å·¥ä½œ

---

### 1. åç«¯æœåŠ¡å¯åŠ¨ä¸é…ç½®

**é—®é¢˜**ï¼šç”¨æˆ·éœ€è¦å¯åŠ¨åç«¯æœåŠ¡

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ `npm run dev` å¯åŠ¨ Next.js åç«¯
- ä¿®æ”¹ PM2 é…ç½®ä» `npm start` æ”¹ä¸º `npm run dev`ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
- åç«¯è¿è¡Œåœ¨ `http://localhost:3000`

---

### 2. åç«¯ API æ¨¡å‹ç­–ç•¥ä¼˜åŒ–

**é—®é¢˜**ï¼šGemini Flash æ¨¡å¼æŒç»­è¶…æ—¶ï¼ˆ20ç§’ï¼‰ï¼Œå¯¼è‡´æ¯æ¬¡æ‰¹æ”¹éœ€è¦ 35-45 ç§’

**è§£å†³æ–¹æ¡ˆ**ï¼š
ä¿®æ”¹ [route.ts](file:///Users/hero/Desktop/ai-grading-backend/src/app/api/ai/grade/route.ts)ï¼Œå°†é»˜è®¤ç­–ç•¥ä» `flash` æ”¹ä¸º `pro`

```diff
- const gradeStrategy = validStrategies.includes(strategy) ? strategy : 'flash';
+ const gradeStrategy = validStrategies.includes(strategy) ? strategy : 'pro';
```

**æ•ˆæœ**ï¼šæ‰¹æ”¹æ—¶é—´ä» 35-45 ç§’å‡å°‘åˆ° 12-22 ç§’

---

### 3. è¯„åˆ†ç†ç”±è¾“å‡ºç®€åŒ–

**é—®é¢˜**ï¼šè¯„åˆ†ç†ç”±è¿‡äºå†—é•¿ï¼ŒåŒ…å«å­¦ç”Ÿç­”æ¡ˆåŸæ–‡å¼•ç”¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
ä¿®æ”¹ [gpt.ts](file:///Users/hero/Desktop/ai-grading-backend/src/lib/gpt.ts) å’Œ [zhipu.ts](file:///Users/hero/Desktop/ai-grading-backend/src/lib/zhipu.ts) ä¸­çš„ prompt

**æ”¹åŠ¨å‰**ï¼š
- å¾—åˆ†æ—¶ï¼šâœ“ + å­¦ç”ŸåŸæ–‡å¼•ç”¨ + åŒ¹é…åˆ°çš„å…³é”®è¯
- æ‰£åˆ†æ—¶ï¼šâœ— + å…·ä½“ç¼ºå¤±å†…å®¹è¯´æ˜

**æ”¹åŠ¨å**ï¼š
- å¾—åˆ†æ—¶ï¼šâœ“ + ç®€çŸ­è¯´æ˜ï¼ˆå¦‚"ç­”å¯¹"ã€"ç¬¦åˆè¦æ±‚"ï¼‰
- æ‰£åˆ†æ—¶ï¼šâœ— + ç®€çŸ­è¯´æ˜ï¼ˆå¦‚"æœªæåŠ"ã€"è¡¨è¿°ä¸å‡†ç¡®"ï¼‰

---

### 4. å¥½åˆ†æ•°å¹³å°è‡ªåŠ¨æäº¤ä¿®å¤

**é—®é¢˜**ï¼šå¥½åˆ†æ•°é˜…å·ç•Œé¢æ— æ³•è‡ªåŠ¨å¡«åˆ†å’Œæäº¤

**æ ¹å› åˆ†æ**ï¼š
- ä»£ç åªé’ˆå¯¹æ™ºå­¦ç½‘(ZHIXUE)å¯ç”¨äº†æ•°å­—é”®ç›˜å¡«åˆ†é€»è¾‘
- å¥½åˆ†æ•°(HAOFENSHU)çš„é€‰æ‹©å™¨ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**ï¼š

#### 4.1 æ·»åŠ é€šç”¨æ•°å­—é”®ç›˜å¡«åˆ†å‡½æ•°
åœ¨ [content.js](file:///Users/hero/Desktop/ai-æ™ºèƒ½æ‰¹æ”¹åŠ©æ‰‹/public/content.js) ä¸­æ·»åŠ  `tryKeypadFillScore` å‡½æ•°

#### 4.2 æ›´æ–°å¥½åˆ†æ•°ç²¾ç¡®é€‰æ‹©å™¨ï¼ˆæ ¹æ®ç”¨æˆ·æä¾›çš„ DOM ä¿¡æ¯ï¼‰

| å…ƒç´  | é€‰æ‹©å™¨ |
|------|--------|
| æ‰“åˆ†è¾“å…¥æ¡† | `input.el-input__inner` |
| æ•°å­—æŒ‰é’® 0-6 | `div.el-col.el-col-5` |
| æäº¤æŒ‰é’® | `button.submit-button.el-button--primary` |

#### 4.3 å¢å¼ºè‡ªåŠ¨æäº¤é€»è¾‘
- å¥½åˆ†æ•°å¹³å°ä¼˜å…ˆæŸ¥æ‰¾å¹¶ç‚¹å‡»"æäº¤"æŒ‰é’®
- å°†å…œåº•å»¶è¿Ÿä» 150ms å¢åŠ åˆ° 300ms

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶åˆ—è¡¨

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `ai-grading-backend/src/app/api/ai/grade/route.ts` | é»˜è®¤ç­–ç•¥æ”¹ä¸º pro |
| `ai-grading-backend/src/lib/gpt.ts` | ç®€åŒ–è¯„åˆ†ç†ç”± prompt |
| `ai-grading-backend/src/lib/zhipu.ts` | ç®€åŒ–è¯„åˆ†ç†ç”± prompt |
| `ai-grading-backend/ecosystem.config.js` | PM2 é…ç½®æ”¹ä¸ºå¼€å‘æ¨¡å¼ |
| `ai-æ™ºèƒ½æ‰¹æ”¹åŠ©æ‰‹/public/content.js` | æ·»åŠ å¥½åˆ†æ•°å¡«åˆ†æ”¯æŒ |

---

## ğŸ”§ å…³é”®ä»£ç å˜æ›´

### content.js ä¸»è¦å˜æ›´

```javascript
// 1. æ·»åŠ é€šç”¨æ•°å­—é”®ç›˜å¡«åˆ†å‡½æ•°
function tryKeypadFillScore(score, platform, options) {
  // æ”¯æŒæ™ºå­¦ç½‘å’Œå¥½åˆ†æ•°
}

// 2. å¥½åˆ†æ•°ç²¾ç¡®é€‰æ‹©å™¨
const haofenshuBtns = document.querySelectorAll('div.el-col.el-col-5');

// 3. å¥½åˆ†æ•°æäº¤æŒ‰é’®ç‚¹å‡»
if (platform === 'HAOFENSHU') {
  const allBtns = document.querySelectorAll('button');
  // æŸ¥æ‰¾å¹¶ç‚¹å‡»"æäº¤"æŒ‰é’®
}
```

---

## âš ï¸ å·²çŸ¥é—®é¢˜

1. **æ•°æ®åº“è¿æ¥ä¸ç¨³å®š**ï¼šSupabase æ•°æ®åº“ `aws-1-ap-northeast-2.pooler.supabase.com` å¶å°”æ— æ³•è¿æ¥ï¼Œå¯¼è‡´ API è¿”å› 500 é”™è¯¯
2. **Gemini Flash è¶…æ—¶**ï¼šå½“å‰ç¯å¢ƒä¸‹ Gemini Flash æ¨¡å‹å“åº”è¾ƒæ…¢ï¼Œå·²ä¸´æ—¶è·³è¿‡
